import{_ as a,o as n,c as i,ag as l}from"./chunks/framework.C63nTIu3.js";const k=JSON.parse('{"title":"第20章：TDSQL 腾讯云实践","description":"","frontmatter":{"title":"第20章：TDSQL 腾讯云实践"},"headers":[],"relativePath":"db/chapter-20.md","filePath":"db/chapter-20.md","lastUpdated":1770797811000}'),e={name:"db/chapter-20.md"};function p(r,s,t,h,o,d){return n(),i("div",null,[...s[0]||(s[0]=[l(`<h1 id="tdsql-腾讯云实践" tabindex="-1">：TDSQL 腾讯云实践 <a class="header-anchor" href="#tdsql-腾讯云实践" aria-label="Permalink to &quot;：TDSQL 腾讯云实践&quot;">​</a></h1><blockquote><p><strong>难度等级</strong>：⭐⭐ 进阶 | <strong>学习时长</strong>：5小时 | <strong>实战项目</strong>：微信支付系统</p></blockquote><h2 id="📚-本章目录" tabindex="-1">📚 本章目录 <a class="header-anchor" href="#📚-本章目录" aria-label="Permalink to &quot;📚 本章目录&quot;">​</a></h2><ul><li><a href="#181-tdsql-概述">18.1 TDSQL 概述</a></li><li><a href="#182-架构设计">18.2 架构设计</a></li><li><a href="#183-nosv-架构">18.3 NOSV 架构</a></li><li><a href="#184-部署与使用">18.4 部署与使用</a></li><li><a href="#185-最佳实践">18.5 最佳实践</a></li></ul><hr><h2 id="tdsql-概述" tabindex="-1">TDSQL 概述 <a class="header-anchor" href="#tdsql-概述" aria-label="Permalink to &quot;TDSQL 概述&quot;">​</a></h2><p><strong>TDSQL</strong> 是<strong>腾讯云</strong> 企业级分布式数据库：</p><ul><li><strong>多地多活</strong>：跨地域容灾</li><li><strong>单元化</strong>：按业务单元隔离</li><li><strong>强一致</strong>：分布式事务 ACID</li><li><strong>高扩展</strong>：弹性伸缩，支持 PB 级</li></ul><h3 id="应用场景" tabindex="-1">应用场景 <a class="header-anchor" href="#应用场景" aria-label="Permalink to &quot;应用场景&quot;">​</a></h3><ul><li>微信支付后台</li><li>腾讯游戏数据库</li><li>京东订单系统</li><li>银行核心交易系统</li></ul><hr><h2 id="架构设计" tabindex="-1">架构设计 <a class="header-anchor" href="#架构设计" aria-label="Permalink to &quot;架构设计&quot;">​</a></h2><h3 id="整体架构" tabindex="-1">整体架构 <a class="header-anchor" href="#整体架构" aria-label="Permalink to &quot;整体架构&quot;">​</a></h3><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>┌─────────────────────────────────────────┐</span></span>
<span class="line"><span>│              TDSQL 集群                 │</span></span>
<span class="line"><span>├─────────────────────────────────────────┤</span></span>
<span class="line"><span>│  计算节点         │  存储节点             │</span></span>
<span class="line"><span>│  (TDSQL Proxy)    │  (TDSQL 存储层)       │</span></span>
<span class="line"><span>│                   │                       │</span></span>
<span class="line"><span>│  SQL 路由         │  数据分片             │</span></span>
<span class="line"><span>│  读写分离         │  多副本               │</span></span>
<span class="line"><span>│  负载均衡         │  弹性扩展             │</span></span>
<span class="line"><span>└─────────────────────────────────────────┘</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><hr><h2 id="nosv-架构" tabindex="-1">NOSV 架构 <a class="header-anchor" href="#nosv-架构" aria-label="Permalink to &quot;NOSV 架构&quot;">​</a></h2><p><strong>NOSV (New One Stop SQL Value)</strong>：</p><ul><li>NewSQL 架构</li><li>一站式 SQL 服务</li><li>支持混合负载</li><li>云原生架构</li></ul><hr><h2 id="部署与使用" tabindex="-1">部署与使用 <a class="header-anchor" href="#部署与使用" aria-label="Permalink to &quot;部署与使用&quot;">​</a></h2><h3 id="腾讯云购买" tabindex="-1">腾讯云购买 <a class="header-anchor" href="#腾讯云购买" aria-label="Permalink to &quot;腾讯云购买&quot;">​</a></h3><ol><li>登录腾讯云控制台</li><li>选择 TDSQL 服务</li><li>创建实例</li><li>配置白名单</li><li>连接数据库</li></ol><h3 id="连接字符串" tabindex="-1">连接字符串 <a class="header-anchor" href="#连接字符串" aria-label="Permalink to &quot;连接字符串&quot;">​</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 内网地址</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">tdsql-postgresql.gz.prod.zone0.tdsqlhost.com:30157</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 使用 psql 连接</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">psql</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -h上述地址</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Uroot</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -p密码</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -dpostgres</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><hr><h2 id="最佳实践" tabindex="-1">最佳实践 <a class="header-anchor" href="#最佳实践" aria-label="Permalink to &quot;最佳实践&quot;">​</a></h2><h3 id="分片键设计" tabindex="-1">分片键设计 <a class="header-anchor" href="#分片键设计" aria-label="Permalink to &quot;分片键设计&quot;">​</a></h3><div class="language-sql vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 选择合适的分片键</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 1. 数据分布均匀</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 2. 避免跨分片查询</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 3. 支持未来扩容</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">-- 创建分片表</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">CREATE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> TABLE</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> orders</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    order_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BIGINT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    user_id </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">BIGINT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    create_time </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">TIMESTAMP</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) SHARDING </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">KEY</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> user_id;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><hr><p><strong>更新时间</strong>：2026年2月 | <strong>版本</strong>：v1.0</p>`,30)])])}const b=a(e,[["render",p]]);export{k as __pageData,b as default};
