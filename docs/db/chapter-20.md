---
title: 第20章：TDSQL 腾讯云实践
---

# ：TDSQL 腾讯云实践

> **难度等级**：⭐⭐ 进阶 | **学习时长**：5小时 | **实战项目**：微信支付系统

## 📚 本章目录

- [18.1 TDSQL 概述](#181-tdsql-概述)
- [18.2 架构设计](#182-架构设计)
- [18.3 NOSV 架构](#183-nosv-架构)
- [18.4 部署与使用](#184-部署与使用)
- [18.5 最佳实践](#185-最佳实践)

---

## TDSQL 概述

**TDSQL** 是**腾讯云** 企业级分布式数据库：

- **多地多活**：跨地域容灾
- **单元化**：按业务单元隔离
- **强一致**：分布式事务 ACID
- **高扩展**：弹性伸缩，支持 PB 级

### 应用场景

- 微信支付后台
- 腾讯游戏数据库
- 京东订单系统
- 银行核心交易系统

---

## 架构设计

### 整体架构

```
┌─────────────────────────────────────────┐
│              TDSQL 集群                 │
├─────────────────────────────────────────┤
│  计算节点         │  存储节点             │
│  (TDSQL Proxy)    │  (TDSQL 存储层)       │
│                   │                       │
│  SQL 路由         │  数据分片             │
│  读写分离         │  多副本               │
│  负载均衡         │  弹性扩展             │
└─────────────────────────────────────────┘
```

---

## NOSV 架构

**NOSV (New One Stop SQL Value)**：

- NewSQL 架构
- 一站式 SQL 服务
- 支持混合负载
- 云原生架构

---

## 部署与使用

### 腾讯云购买

1. 登录腾讯云控制台
2. 选择 TDSQL 服务
3. 创建实例
4. 配置白名单
5. 连接数据库

### 连接字符串

```bash
# 内网地址
tdsql-postgresql.gz.prod.zone0.tdsqlhost.com:30157

# 使用 psql 连接
psql -h上述地址 -Uroot -p密码 -dpostgres
```

---

## 最佳实践

### 分片键设计

```sql
-- 选择合适的分片键
-- 1. 数据分布均匀
-- 2. 避免跨分片查询
-- 3. 支持未来扩容

-- 创建分片表
CREATE TABLE orders (
    order_id BIGINT,
    user_id BIGINT,
    create_time TIMESTAMP
) SHARDING KEY = user_id;
```

---

**更新时间**：2026年2月 | **版本**：v1.0
